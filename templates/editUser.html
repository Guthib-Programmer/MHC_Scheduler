{% extends "base.html" %}

{% block head %}

{% endblock %}

{% block body %}
<nav> <!-- Navbar -->
    <a href="./">MHC Scheduler</a>
    <div>
        <a href="./account">Admin</a>
        <a href="./signin">Account</a>
    </div>
</nav>
<main class="editUser">
    {% if user == 0 %}
    <form action="./editUser?id=0" method="post" class="editUser">
        <p style="color:red; text-align: center; font-size: 1.5rem;">{{ warn }}</p>
        <input type="hidden" name="new" value="1">
        <input required autocomplete="off" type="text" name="name" placeholder="Name">
        <input required autocomplete="off" type="password" name="password" placeholder="Password"id="password">
        <span><input type="checkbox" name="showpassword" id="showPassword" onclick="togglePasswordVisibility()"><label for="showPassword">Show Password</label></span>
        <input required autocomplete="off" type="email" name="email" placeholder="Email">
        <h3>Sessions</h3>
        <div class="sessions">
            <div>
                <input type="checkbox" name="sessions" value="1" id="mm"><label for="mm">Monday Morning</label><br>
                <input type="checkbox" name="sessions" value="4" id="tm"><label for="tm">Tuesday Morning</label><br>
                <input type="checkbox" name="sessions" value="16" id="wm"><label for="wm">Wednesday Morning</label><br>
                <input type="checkbox" name="sessions" value="64" id="thm"><label for="thm">Thursday Morning</label><br>
                <input type="checkbox" name="sessions" value="256" id="fm"><label for="fm">Friday Morning</label><br>
            </div>
            <div>
                <input type="checkbox" name="sessions" value="2" id="ma"><label for="ma">Monday Afternoon</label><br>
                <input type="checkbox" name="sessions" value="8" id="ta"><label for="ta">Tuesday Afternoon</label><br>
                <input type="checkbox" name="sessions" value="32" id="wa"><label for="wa">Wednesday Afternoon</label><br>
                <input type="checkbox" name="sessions" value="128" id="tha"><label for="tha">Thursday Afternoon</label><br>
                <input type="checkbox" name="sessions" value="512" id="fa"><label for="fa">Friday Afternoon</label>
            </div>
        </div>
        <span><input checked type="checkbox" name="updateWeight" id="weight"><label for="weight">Update oncall weight based on sessions</label></span>
        <input required autocomplete="off" type="number" name="weight" min="0" max="10" step="1" placeholder="Oncall Weight (1-10)" value="0">
        <input required autocomplete="off" type="text" name="color" placeholder="HTML Color" id="colorInput">
        <div class="sessions">
            <label for="active">Start Now: </label>
            <input type="radio" name="start" value="now" id="active">
        </div>
        <div class="sessions">
            <label for="startDateCheck">Start Date: </label>
            <input type="radio" name="start" id="startDateCheck">
            <input type="date" name="startDate" value="date" placeholder="Start Date" id="DatePicker">
        </div>
        <div class="sessions">
            <label for="endDateCheck">End Date:  </label>
            <input type="checkbox" name="endDateCheck" id="endDateCheck">
            <input type="date" name="endDate" placeholder="Start Date" id="endDatePicker">
        </div>
        <span><input type="checkbox" name="admin" id="admin"><label for="admin">Admin Permissions</label></span>
        <input type="submit" value="Submit">

    {% else %}
    <form action="./editUser?id={{ user['id'] }}" method="post" class="editUser">
        <p style="color:red; text-align: center; font-size: 1.5rem;">{{ warn }}</p>
        {% if isNew is defined %}
        <input type="hidden" name="new" value="1">
        {% else %}
        <input type="hidden" name="id" value="{{ user['id'] }}">
        {% endif %}
        <input required autocomplete="off" type="text" name="name" placeholder="Name" value="{{ user['name'] }}">
        <input required autocomplete="off" type="password" name="password" placeholder="Password" value="{{ user['password'] }}" id="password">
        <span><input type="checkbox" name="showpassword" id="showPassword" onclick="togglePasswordVisibility()"><label for="showPassword">Show Password</label></span>
        <input required autocomplete="off" type="email" name="email" placeholder="Email" value="{{ user['email'] }}">
        <h3>Sessions</h3>
        <div class="sessions">
            <div>
                <input {{ sessionData['mm'] }} type="checkbox" name="sessions" value="1" id="mm"><label for="mm">Monday Morning</label><br>
                <input {{ sessionData['tm'] }} type="checkbox" name="sessions" value="4" id="tm"><label for="tm">Tuesday Morning</label><br>
                <input {{ sessionData['wm'] }} type="checkbox" name="sessions" value="16" id="wm"><label for="wm">Wednesday Morning</label><br>
                <input {{ sessionData['thm'] }} type="checkbox" name="sessions" value="64" id="thm"><label for="thm">Thursday Morning</label><br>
                <input {{ sessionData['fm'] }} type="checkbox" name="sessions" value="256" id="fm"><label for="fm">Friday Morning</label><br>
            </div>
            <div>
                <input {{ sessionData['ma'] }} type="checkbox" name="sessions" value="2" id="ma"><label for="ma">Monday Afternoon</label><br>
                <input {{ sessionData['ta'] }} type="checkbox" name="sessions" value="8" id="ta"><label for="ta">Tuesday Afternoon</label><br>
                <input {{ sessionData['wa'] }} type="checkbox" name="sessions" value="32" id="wa"><label for="wa">Wednesday Afternoon</label><br>
                <input {{ sessionData['tha'] }} type="checkbox" name="sessions" value="128" id="tha"><label for="tha">Thursday Afternoon</label><br>
                <input {{ sessionData['fa'] }} type="checkbox" name="sessions" value="512" id="fa"><label for="fa">Friday Afternoon</label>
            </div>
        </div>
        <span><input checked type="checkbox" name="updateWeight" id="weight"><label for="weight">Update oncall weight based on sessions</label></span>
        <input required autocomplete="off" type="number" name="weight" min="0" max="10" step="1" placeholder="Oncall Weight (1-10)" value="0">
        <input required autocomplete="off" type="text" name="color" placeholder="HTML Color" value="{{ user['color'] }}" id="colorInput">
        <div class="sessions">
            <label for="active">Active: </label>
            {% if user['active'] == 1 %}
            <input checked type="radio" name="start" value="now" id="active">
            {% else %}
            <input type="radio" name="start" value="now" id="active">
            {% endif %}
        </div>
        <div class="sessions">
            <label for="startDateCheck">Start Date: </label>
            {% if user['activate_date'] != None %}
            <input checked type="radio" name="start" id="startDateCheck">
            <input value="{{ user['activate_date'] }}" type="date" name="startDate" id="DatePicker">
            {% else %}
            <input type="radio" name="start" id="startDateCheck">
            <input type="date" name="startDate" id="DatePicker">
            {% endif %}
        </div>
        <div class="sessions">
            <label for="endDateCheck">End Date:  </label>
            {% if user['finish_date'] is defined %}
            <input checked type="checkbox" name="endDateCheck" id="endDateCheck">
            <input value="{{ user['finish_date'] }}" type="date" name="endDate" id="endDatePicker">
            {% else %}
            <input type="checkbox" name="endDateCheck" id="endDateCheck">
            <input type="date" name="endDate" placeholder="Start Date" id="endDatePicker">
            {% endif %}
        </div>
        {% if user['admin'] == 1 %}
        <span><input checked type="checkbox" name="admin" id="admin"><label for="admin">Admin Permissions</label></span>
        {% else %}
        <span><input type="checkbox" name="admin" id="admin"><label for="admin">Admin Permissions</label></span>
        {% endif %}
        <input type="submit" value="Submit">
    </form>
    {% endif %}
</main>
<script>
    function togglePasswordVisibility() {
        var x = document.getElementById("password");
        if (x.type === "password") {
            x.type = "text";
        } else {
            x.type = "password";
        }
    }

    function updateColorInput()
    {
        colourInput = document.getElementById("colorInput");
        colourInput.style.color = colourInput.value;
        if (colourInput.style.color != colourInput.value)
        {
            colourInput.style.color = "black"
        }
    }

    document.getElementById("colorInput").addEventListener("keyup", updateColorInput)

    updateColorInput();
</script>
{% endblock %}